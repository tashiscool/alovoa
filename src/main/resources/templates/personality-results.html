<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments :: head}"></head>

<body class="aura-page">
<link rel="stylesheet" th:href="@{/css/aura.css}"/>
<div th:replace="~{fragments :: header}"></div>

<!-- Hero Section -->
<div class="aura-hero">
    <h1><i class="fas fa-brain mr-2"></i> <span th:text="#{personality.results.title}">Your Personality Profile</span></h1>
    <p>Discover what makes you uniquely you</p>
</div>

<div class="aura-container">
    <!-- Radar Chart Card -->
    <div class="aura-card aura-animate-fade-up" style="padding: 2rem; margin-bottom: 1.5rem;">
        <div class="aura-card-header" style="justify-content: center; margin-bottom: 1.5rem;">
            <div class="aura-card-icon"><i class="fas fa-chart-radar"></i></div>
            <div>
                <div class="aura-card-title">Big Five Personality Traits</div>
                <div class="aura-card-subtitle">Your unique personality fingerprint</div>
            </div>
        </div>
        <div style="max-width: 500px; margin: 0 auto;">
            <canvas id="big-five-chart" height="300"></canvas>
        </div>
    </div>

    <!-- Trait Cards Grid -->
    <div class="aura-traits-grid aura-stagger">
        <!-- Openness -->
        <div class="aura-card aura-trait-card">
            <div class="aura-trait-header">
                <div class="aura-trait-icon" style="background: linear-gradient(135deg, #7c3aed, #a855f7);">
                    <i class="fas fa-lightbulb"></i>
                </div>
                <div>
                    <h3 th:text="#{personality.openness}">Openness</h3>
                    <span class="aura-trait-score" th:text="${profile.openness + '%'}">75%</span>
                </div>
            </div>
            <div class="aura-progress-bar">
                <div class="aura-progress-fill" th:style="'width: ' + ${profile.openness} + '%'"></div>
            </div>
            <p class="aura-trait-desc" th:text="#{personality.openness.desc}">
                Your curiosity and openness to new experiences.
            </p>
        </div>

        <!-- Conscientiousness -->
        <div class="aura-card aura-trait-card">
            <div class="aura-trait-header">
                <div class="aura-trait-icon" style="background: linear-gradient(135deg, #059669, #10b981);">
                    <i class="fas fa-tasks"></i>
                </div>
                <div>
                    <h3 th:text="#{personality.conscientiousness}">Conscientiousness</h3>
                    <span class="aura-trait-score" th:text="${profile.conscientiousness + '%'}">80%</span>
                </div>
            </div>
            <div class="aura-progress-bar">
                <div class="aura-progress-fill" th:style="'width: ' + ${profile.conscientiousness} + '%'" style="background: var(--aura-gradient-success);"></div>
            </div>
            <p class="aura-trait-desc" th:text="#{personality.conscientiousness.desc}">
                Your organization and dependability.
            </p>
        </div>

        <!-- Extraversion -->
        <div class="aura-card aura-trait-card">
            <div class="aura-trait-header">
                <div class="aura-trait-icon" style="background: linear-gradient(135deg, #f59e0b, #fbbf24);">
                    <i class="fas fa-users"></i>
                </div>
                <div>
                    <h3 th:text="#{personality.extraversion}">Extraversion</h3>
                    <span class="aura-trait-score" th:text="${profile.extraversion + '%'}">60%</span>
                </div>
            </div>
            <div class="aura-progress-bar">
                <div class="aura-progress-fill" th:style="'width: ' + ${profile.extraversion} + '%'" style="background: linear-gradient(90deg, #f59e0b, #fbbf24);"></div>
            </div>
            <p class="aura-trait-desc" th:text="#{personality.extraversion.desc}">
                Your energy from social interactions.
            </p>
        </div>

        <!-- Agreeableness -->
        <div class="aura-card aura-trait-card">
            <div class="aura-trait-header">
                <div class="aura-trait-icon" style="background: linear-gradient(135deg, #0ea5e9, #38bdf8);">
                    <i class="fas fa-heart"></i>
                </div>
                <div>
                    <h3 th:text="#{personality.agreeableness}">Agreeableness</h3>
                    <span class="aura-trait-score" th:text="${profile.agreeableness + '%'}">85%</span>
                </div>
            </div>
            <div class="aura-progress-bar">
                <div class="aura-progress-fill" th:style="'width: ' + ${profile.agreeableness} + '%'" style="background: linear-gradient(90deg, #0ea5e9, #38bdf8);"></div>
            </div>
            <p class="aura-trait-desc" th:text="#{personality.agreeableness.desc}">
                Your compassion and cooperation with others.
            </p>
        </div>

        <!-- Emotional Stability -->
        <div class="aura-card aura-trait-card">
            <div class="aura-trait-header">
                <div class="aura-trait-icon" style="background: linear-gradient(135deg, #ec4899, #f472b6);">
                    <i class="fas fa-balance-scale"></i>
                </div>
                <div>
                    <h3 th:text="#{personality.neuroticism}">Emotional Stability</h3>
                    <span class="aura-trait-score" th:text="${(100 - profile.neuroticism) + '%'}">70%</span>
                </div>
            </div>
            <div class="aura-progress-bar">
                <div class="aura-progress-fill" th:style="'width: ' + ${100 - profile.neuroticism} + '%'" style="background: var(--aura-gradient-warm);"></div>
            </div>
            <p class="aura-trait-desc" th:text="#{personality.neuroticism.desc}">
                Your emotional resilience and stability.
            </p>
        </div>

        <!-- Attachment Style -->
        <div class="aura-card aura-trait-card">
            <div class="aura-trait-header">
                <div class="aura-trait-icon" style="background: var(--aura-gradient);">
                    <i class="fas fa-link"></i>
                </div>
                <div>
                    <h3 th:text="#{personality.attachment}">Attachment Style</h3>
                    <span class="aura-trait aura-trait-positive" th:text="${profile.attachmentStyle}" style="margin-top: 0.25rem;">Secure</span>
                </div>
            </div>
            <p class="aura-trait-desc" th:text="#{personality.attachment.desc}" style="margin-top: 1rem;">
                How you relate to others in close relationships.
            </p>
        </div>
    </div>

    <!-- Matching Insights -->
    <div class="aura-alert aura-alert-success aura-animate-fade-up" th:if="${matchingInsights}" style="margin-top: 1.5rem;">
        <i class="fas fa-heart fa-lg"></i>
        <div>
            <strong th:text="#{personality.matching.insights}">What This Means for Your Matches</strong>
            <ul style="margin-top: 0.5rem; padding-left: 1.25rem;">
                <li th:each="insight : ${matchingInsights}" th:text="${insight}"></li>
            </ul>
        </div>
    </div>

    <!-- Action Buttons -->
    <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem; flex-wrap: wrap;">
        <a th:href="@{/personality/assessment}" class="aura-btn aura-btn-secondary">
            <i class="fas fa-redo"></i> <span th:text="#{personality.retake}">Retake Assessment</span>
        </a>
        <a th:href="@{/}" class="aura-btn aura-btn-primary aura-btn-lg">
            <i class="fas fa-heart"></i> <span th:text="#{personality.find.matches}">Find Matches</span>
        </a>
    </div>
</div>

<div th:replace="~{fragments :: footer}"></div>

<script src="/js/lib/chart.min.js"></script>
<script th:inline="javascript">
    const profile = {
        openness: [[${profile.openness}]],
        conscientiousness: [[${profile.conscientiousness}]],
        extraversion: [[${profile.extraversion}]],
        agreeableness: [[${profile.agreeableness}]],
        neuroticism: [[${profile.neuroticism}]]
    };

    // Detect dark mode
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const textColor = isDarkMode ? '#e5e7eb' : '#374151';
    const gridColor = isDarkMode ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';

    const ctx = document.getElementById('big-five-chart').getContext('2d');

    // Create gradient
    const gradient = ctx.createLinearGradient(0, 0, 300, 300);
    gradient.addColorStop(0, 'rgba(124, 58, 237, 0.3)');
    gradient.addColorStop(1, 'rgba(236, 72, 153, 0.3)');

    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Openness', 'Conscientiousness', 'Extraversion', 'Agreeableness', 'Emotional Stability'],
            datasets: [{
                label: 'Your Profile',
                data: [
                    profile.openness,
                    profile.conscientiousness,
                    profile.extraversion,
                    profile.agreeableness,
                    100 - profile.neuroticism
                ],
                fill: true,
                backgroundColor: gradient,
                borderColor: '#7c3aed',
                borderWidth: 3,
                pointBackgroundColor: '#7c3aed',
                pointBorderColor: '#fff',
                pointBorderWidth: 2,
                pointRadius: 6,
                pointHoverBackgroundColor: '#ec4899',
                pointHoverBorderColor: '#fff',
                pointHoverRadius: 8
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                r: {
                    angleLines: {
                        display: true,
                        color: gridColor
                    },
                    grid: {
                        color: gridColor
                    },
                    pointLabels: {
                        color: textColor,
                        font: {
                            size: 12,
                            weight: '600'
                        }
                    },
                    ticks: {
                        color: textColor,
                        backdropColor: 'transparent',
                        stepSize: 20
                    },
                    suggestedMin: 0,
                    suggestedMax: 100
                }
            }
        }
    });
</script>

<style>
    .aura-traits-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1rem;
    }

    .aura-trait-card {
        padding: 1.5rem;
    }

    .aura-trait-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1rem;
    }

    .aura-trait-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.25rem;
        flex-shrink: 0;
    }

    .aura-trait-header h3 {
        margin: 0;
        font-size: 1rem;
        font-weight: 600;
        color: var(--aura-gray-800);
    }

    .aura-trait-score {
        font-size: 1.5rem;
        font-weight: 700;
        background: var(--aura-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .aura-trait-desc {
        font-size: 0.875rem;
        color: var(--aura-gray-500);
        margin-top: 0.75rem;
        line-height: 1.5;
    }

    @media (prefers-color-scheme: dark) {
        .aura-trait-header h3 {
            color: var(--aura-gray-100);
        }
    }
</style>

</body>
</html>
